\documentclass[10pt,a4paper]{report}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{hyperref}


\title{Midterm: Character RNN}
\author{Alex Shah - MSCS 692}
\date{10/20/17}

\begin{document}

\lstset{language=Python}
\maketitle

\section{Code}
\lstinputlisting[language=Python,frame=single, breaklines=true]{characterRNN.py}

\clearpage

\section{Part 1: Hidden Units}

\begin{table}[h]
 \caption{Hidden Units effect on Perplexity}
 \label{tbl:aTable}
 \begin{center}
  \begin{tabular}{lccrrrrrr}
    \hline 
	Hidden Units & Perplexity\\
	\hline
	32 & 1.829\\
	64 & 1.632\\
	128 & 1.412\\
	256 & 1.248\\
	512 & 0.990\\
  \end{tabular}
 \end{center}
\end{table}

\subsection{Part 1: Analysis}

\paragraph{
As the number of hidden units increases, there is a marked drop in perplexity. Perplexity represents the difficulty the net has in predicting output. In this character RNN, the perplexity decreasing means that the network has an easier time predicting characters. These hidden units allow for more information to be factored into producing character output. The direct result of increasing hidden units is that the embedding, or vectorization of characters, is expanded by the increase in hidden units size. The effect this has on perplexity is apparent in Table 1.
}
\
\vspace{5mm}

``The the dounch and pest as he schenged my trote to spr``

\ 
Sample from 32 hidden units 
\vspace{5mm}

``The bears: O, would he done a knew of your malice``

\ 
Sample from 512 hidden units 
\

\paragraph{
Looking at the sentences produced by the lowest number of hidden units, 32, almost none of the words produced are English words. Very few of the sentences are readable, and even fewer follow any semblance of sentence structure. Compared to the higher hidden unit output, this seems almost random even by the end of training. At 512 hidden units, most if not all words are either English words or close approximations. Punctuation and symbols are used in ways that seem to mirror the source material, such as a character name and colon followed by a newline preceding what must be that character's dialogue. The spelling, syntax, and overall structure of sentences produced are much more readable and some later epochs are wholly correct with higher hidden units.
}

\clearpage

\section{Part 2: Sequence Length}

\begin{table}[h]
 \caption{Sequence Length effect on Perplexity}
 \label{tbl:bTable}
 \begin{center}
  \begin{tabular}{lccrrr}
    \hline 
	Sequence Length & Perplexity\\
	\hline
	25 & 1.336\\
	50 & 1.412\\
	75 & 1.357\\
  \end{tabular}
 \end{center}
\end{table}

\subsection{Part 2: Analysis}

\paragraph{
The sequence length is how many characters the RNN takes into account for modeling prediction and context. The output and states from longer or shorter sequences affect the predictions formed, but not the ease at which the net can predict them. Thus, changing the sequence from 25 to 75 has very little affect on perplexity. There seems to be diminishing returns to increasing past a certain point, and 75 is no better able to predict characters than a lower value.
}

\
\vspace{5mm}

``The Froths are in Boney?

Proffil
piad, that I'll keep with:
Bain a town; and h''

\ 
Sample from 25 sequence length
\vspace{5mm}

``The devil's, thus, and that I did make of your noted to answerful, since he''

\ 
Sample from 75 sequence length
\

\paragraph{
We can see that with a shorter sequence length the contextual accuracy of sentences, such as forming valid English words and structure, are diminished. In comparison, the longer sequence length is comprehensible, it seems like a line right out of the source material. However, grammar structure is not fully formed with so few epochs. This demonstrates the sequence length's effect on context and accuracy beyond just predicting the next character. The sequence length affects how well that outputs fits overall in a human readable sentence where a longer sequence length better captures context or patterns in a given sequence. It is still just as difficult (the perplexity remaining the same) to predict the characters, but the "understanding" that comes with a longer sequence length is reflected in the output text.
}

\clearpage

\subsection{Part 3: 50 Sequences of Grey}

\paragraph{I decided to run this on a dataset consisting of the entire 50 Shades of Grey novel. For your enjoyment, computer generated romance:}
\
\vspace{5mm}

``\href{https://raw.githubusercontent.com/AlexKShah/MSCS692/master/midterm/output/50shades-long.txt}{50 Shades Long}''

\vspace{5mm}

``\href{https://raw.githubusercontent.com/AlexKShah/MSCS692/master/midterm/output/50shades.txt}{50 Shades Med}''

\vspace{5mm}

``\href{https://raw.githubusercontent.com/AlexKShah/MSCS692/master/midterm/output/50shades-short.txt}{50 Shades Short}''
\
\end{document}